  Разработанная в курсовом проекте база данных решает задачи контроля и 
отслеживания выпускаемой в рамках определенных проектов документации.
  Гипотетическая организация (в качестве аналога в части выполняемых функций 
взят "Центр инжиниринга и управления строительства единой энергетической
системы") занимается контролем взаимодействия между заказчиками проектов 
(компании энергетического комплекса), генподрядчиками (компании, выигравшие
тендер на строительство) и субподрядчиками (компании, занимающиеся разработкой
документации для проекта).
  Конечным результатом взаимодействия является согласованная версия документации, 
направляемая заказчику.
  БД содержит следующие таблицы:
1. departments - список департаментов контролирующей организации.
2. divisions - список отделов контролирующей организации.
3. positions - список должностей сотрудников контролирующей организации.
4. phone_numbers - список телефонных номеров контролирующей организации.
5. stages - стадии разрабатываемой документации:
   ПД - проектная документация;
   РД - рабочая документация;
   КД - конкурсная документация;
   ППО - предпроектное обследование.
6. cities - список городов, в которых находятся организации, взаимодействующие
   контролирующей организацией.
7. expertises - список учреждений, в которых разрабатываемая документация
   проходит государственую экспертизу. 
8. subcontractors - организации, разрабатывающие документацию под проекты.
9. gencontractors - организации, выигравшие тендер на строительство и разработку
   документации (разработка документации выполняется субподрядчиками).
10. customers - компании энергетического комплекса, выступающие заказчиками
   проектов.
11. employees - сотрудники контролирующей организации.
12. projects - список титулов (проектов), находившихся или находящихся в ведении
   контролирующей организации. Содержит информацию о заказчике проекта, ген и
   субподрядчике, экспертизе, в которую направлялась документация, и даты начала и
   окончания работ по титулу.
13. documentation - содержит полный список конкретных томов и книг документации, 
   разрабатываемой под контролируемые проекты. Содержит информацию о принадлежности
   документации конкретному проекту, стадии, дате начала и окончания разработки.
14. versions - содержит все версии разработанной документации с указанием номера
   изменения, даты и отметки о том, была ли данная версия направлена заказчику.
15. invoices - список накладных на отправку документации заказчику с указанием
   количества экземпляров документации, даты и того, за чьей подписью документация
   отправлена по накладной.
16. dispatches - содержит полный список отправленной за весь период работы 
   документации (с указанием финальной версии) и соответствующего номера накладной
   на отправку.
----------------------------------------------------------------------------------------
Прилагаемые файлы (скрипты с файлами желательно выполнять в порядке их перечислания,
так как таким образом явно прослеживается логика работы процедур и триггеров):
1) doc_flow_db_tables (скрипты создания таблиц);
2) doc_flow_db_data (скрипты наполнения таблиц данными);
3) doc_flow_db_select (скрипты выборок на основе вложенных запросов и join);
4) doc_flow_views (views);
5) doc_flow_procedures (хранимы процедуры);
6) doc_flow_triggers (триггеры и функции).
----------------------------------------------------------------------------------------
Пояснение по выборкам (файл doc_flow_db_select):
1. Выборка проектов и заказчиков, отсортированный по имени заказчика.
2. Выборка документации по названию титула и стадии документации.
3. Выборка для анализа затрачиваемого времени на тома/книги документации
в рамках проекта. Отсортирована по количеству дней в порядке убывания.
4. Выборка с группировкой для анализа количества проектов для каждого из заказчиков
и общего числа контролируемых проектов.
5. Выборка, показывающая какие из потенциальных заказчиков на данный момент времени
не заказали ни одного проекта.
6. Выборка, показывающая список документации, отправленной заказчику для определенного
номера договора.
7. Выборка, показывающая не завершенную на данный момент времени документацию и лиц,
курирующих процесс разработки.
8. Выборка, показывающая по какой накладной и какая именно версия документации
была отправлена заказчику для определенного шифра документации.
9. Выборка отправленной за определенный период времени документации.
10. Выборка с derived table. Выдает количество документации, завершенной за 
определенный период с группировкой по проектам для определенной стадии.
11. Выборка работников определенного департамента с количеством томов/книг
документации, которую они курировали.
12. Динамический запрос. Позволяет, зная часть имени проекта и стадию,
найти все накладные, которыми документация направлялась заказчику.
----------------------------------------------------------------------------------------
Пояснение по представлениям (файл doc_flow_views):

- employees_info 
Содержит информацию о работниках в удобной для восприятия форме.

- unfinished_doc
Содержит информацию о всей не согласованной на данный момент времени документации
и работниках, курирующих процесс согласования.

- project_info
Содержит информацию о контролируемых проектах в удобной для восприятия форме.
----------------------------------------------------------------------------------------
Пояснение по представлениям (файл doc_flow_procedures):

- sp_show_docs
Позволяет запрашивать список документации, зная часть названия титула и стадию.

- sp_insert_csg
Позволяет добавлять информация в одну из трех таблиц: customers, gencontractors, 
subcontractors.

- sp_add_project
Позволяет добавлять новый проект (титул) в таблицу projects.

- sp_add_docum
Позволяет добавлять тома/книги в таблицу documentation.

Процедуры sp_add_project и sp_add_docum также позволяют отлавдивать код и информацию
об ошибках при вставке данных в таблицы.
----------------------------------------------------------------------------------------
Пояснение по триггерам (файл doc_flow_triggers):

- change_is_sent_status:
До добавления данного триггера статус отправки документации в таблице versions 
(столбец is_sent) заполнялся вручную. Триггер меняет is_sent на 1 автоматически
как только документация добавляется в таблицу dispatches. Для проверки выполняются 
сначала процедуры 3 и 4 из файла doc_flow_procedures, затем в файле doc_flow_triggers
создаем триггер change_is_sent_status и проверяем его работу, добавляя новую
документацию в отправки. Процесс пошагово расписан в комментариях в файле триггера.

- set_emp_email:
До добавления триггера электронная почта сотрудника в таблицу employees вводилась
вручную. Триггер change_is_sent_status совместно с функцией convert_func (создается
в этом же файле) автоматически создает адрес электронной почты для вновь 
добавляемого сотрудника на основе его ФИО.
Функция convert_func предназначена для преоборазования кириллицы в латиницу для
создания электронного адреса на основе русскоязычных имени и фамилии сотрудника.

- check_invoice_insert и check_invoice_update защищают от добавления в таблицу
накладных invoices номера накладной, которая первые семь цифр которого не соответствуют
номеру договора из таблицы projects, а также от изменения существующего в таблице
номера накладной на номер, не соответствующий ни одному из номеров существующих
договоров.
----------------------------------------------------------------------------------------

